# Process and Thread (and their differences)

이들의 구조는 일단 프로그램 -> 프로세스 -> 스레드 이다.
> 프로그램이란 파일이 저장 장치에 저장되어 있지만 메모리에는 올라가 있지 않은 정적인 상태를 말한다. (코드 덩어리)

### Process

- 프로그램을 실행한 것이 프로세스이다.
- 프로세스 간 메모리 공유 불가
- 코드, 데이터, 스택, 힙 형식으로 데이터를 할당 받는다.
- 다른 프로세스가 종료 되어도 영향 받지 않는다.
>멀티태스킹: 하나의 운영체제 안에서 여러 프로세스가 실행

#### Process Control Block - PCB (프로세스 제어 블록)

- PCB는 특정 프로세스에 대한 중요한 정보를 저장 하고 있는 운영체제의 자료구조이다. 운영체제는 프로세스 생성과 동시에 고유한 PCB를 생성한다. 프로세스는 작업을 처리하다가도 프로세스 전환이 발생하면 진행하던 작업을 저장하고 CPU를 반환해야 하는데, 이때 작업의 진행상황을 모두 PCB에 저장하게 된다. 그리고 다시 할당받게 되면 PCB에 저장되어있던 내용을 불러와 이전에 종료됐던 시점부터 다시 작업을 수행한다.

>PCB에 저장되는 정보
> - 프로세스 식별자(Process ID, PID): 프로세스 식별번호
> - 프로세스 상태: new, ready, running, waiting, terminated 등의 상태를 저장
> - 프로그램 카운터: 다음에 실행할 명령어의 주소
> - CPU 레지스터
> - CPU 스케쥴링 정보: 프로세스의 우선순위, 스케줄 큐에 대한 포인터 등
> - 메모리 관리 정보: 페이지 테이블 또는 세그먼트 테이블 등과 같은 정보를 포함
> - 입출력 상태 정보: 프로세스에 할당된 입출력 장치들과 열린 파일 목록
> - 어카운팅 정보: 사용된 CPU 시간, 시간제한, 계정번호 등

### Thread

- 프로세스의 코드에 정의된 절차에 따라 실행되는 특정한 수행 경로다.
- 코드 내에 선언된 함수들이 스레드
- 프로세스 와는 다른 더 작은 실행 단위 개념이다. (프로세스 안에서 나누어진 작업들)
- 스레드 간 메모리 공유 가능
- 스택 영역 제외 나머지 형식의 영역은 공유한다. (힙 메모리를 서로 읽고 쓴다)
- 한 스레드가 오류 발생시 같은 프로세스 내의 다른 스레드가 모두 종료된다.

>멀티스레드: 하나의 프로세스가 여러 스레드로 여러작업을 동시 처리하는 것

>멀티스레드 장점: context-switching 할 때 공유하고 있는 메모리 만큼의 메모리 자원을 아낄 수 있다. / 스택 제외 모든 메모리를 공유하기에 통신의 부담이 적어 응답시간이 빠르다.

>멀티스레드 단점: 하나의 자원을 망친다면 모든 프로세스가 종료될 수 있다. / 자원을 공유하기에 동기화 문제 발생할 수 있다.

>PC Register(스레드가 명령어의 어디까지 수행해였는지 나타냄)를 스레드마다 독립적으로 할당하는 이유는 스레드는 CPU를 할당받았다가 스케줄러에 의해 다시 선점당한다. 그렇기에 명령어가 연속적으로 수행되지 못하고 어느 부분까지 수행했는지 기억할 필요가 있다. 그래서 독립적으로 PC Register를 할당한다.


### Process vs Thread

- 개념의 범위가 다르다 스레드는 프로세스 안에 포함됨
- 운영체제가 프로세스에게 코드/데이터/스택/힙 메모리 영역을 할당해 주고 최소 작업 단위로 삼는 반면, 스레드는 프로세스 내에서 스택 제외 다른 메모리 영역을 같은 프로세스 내 다른 스레드와 공유한다.
- 프로세스는 다른 프로세스와 정보 공유를 하려면 IPC등 번거로운 과정을 거쳐야 하지만, 스레드는 기본 구조 자체가 메모리를 공유하는 구조이기 때문에 다른 스레드와 정보 공유가 쉽다.
- 따라서 멀티 태스킹보다 멀티 스레드가 자원을 더 아낀다 / 하지만 스케줄링은 스레드를 지원하지 않기에 프로그래머가 직접 동기화 문제를 대응해야 한다.
